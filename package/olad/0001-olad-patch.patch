--- a/config/ola.m4
+++ b/config/ola.m4

@@ -24,6 +24,11 @@
 AC_REQUIRE_CPP()
 PKG_CHECK_MODULES(libprotobuf, [protobuf >= $1])
 
+AC_MSG_CHECKING([protobuf library version])
+PROTOBUF_VERSION=`pkg-config --modversion protobuf`;
+AC_MSG_RESULT([$PROTOBUF_VERSION])
+AC_SUBST([PROTOBUF_VERSION])
+
 AC_SUBST([libprotobuf_CFLAGS])
 
 AC_ARG_WITH([protoc],
@@ -44,28 +49,7 @@
   AC_MSG_ERROR([cannot find 'protoc' program]);
 elif test -n "$1" ; then
   AC_MSG_CHECKING([protoc version])
-  [protoc_version=`$PROTOC --version 2>&1 | grep 'libprotoc' | sed 's/.*\([0-9][0-9]*\.[0-9][0-9]*\.[0-9][0-9]*\).*/\1/g'`]
-  [required=$1]
-  [required_major=`echo $required | sed 's/[^0-9].*//'`]
-  [required_minor=`echo $required | sed 's/[0-9][0-9]*\.\([0-9][0-9]*\)\.[0-9][0-9]*/\1/'`]
-  [required_patch=`echo $required | sed 's/^.*[^0-9]//'`]
-  [actual_major=`echo $protoc_version | sed 's/[^0-9].*//'`]
-  [actual_minor=`echo $protoc_version | sed 's/[0-9][0-9]*\.\([0-9][0-9]*\)\.[0-9][0-9]*/\1/'`]
-  [actual_patch=`echo $protoc_version | sed 's/^.*[^0-9]//'`]
-
-  protoc_version_proper=`expr \
-    $actual_major \> $required_major \| \
-    $actual_major \= $required_major \& \
-    $actual_minor \> $required_minor \| \
-    $actual_major \= $required_major \& \
-    $actual_minor \= $required_minor \& \
-    $actual_patch \>= $required_patch `
-
-  if test "$protoc_version_proper" = "1" ; then
-    AC_MSG_RESULT([$protoc_version])
-  else
-    AC_MSG_ERROR([protoc version too old $protoc_version < $required]);
-  fi
+  AC_MSG_RESULT([Version check skipped])
 fi
 
 AC_ARG_WITH([ola-protoc-plugin],
@@ -79,21 +63,10 @@
   echo "set ola_protoc to $OLA_PROTOC"
 else
   OLA_PROTOC="$PROTOC --plugin=protoc-gen-cppservice=\$(top_builddir)/protoc/ola_protoc_plugin${EXEEXT}";
-  AC_CHECK_HEADER(
-      [google/protobuf/compiler/command_line_interface.h],
-      [],
-      AC_MSG_ERROR([Cannot find the protoc header files]))
-  SAVED_LIBS=$LIBS
-  LIBS="$LIBS -lprotoc"
-  AC_LINK_IFELSE(
-    [AC_LANG_PROGRAM([#include <google/protobuf/compiler/command_line_interface.h>],
-      [google::protobuf::compiler::CommandLineInterface cli])],
-    [TEST_LIBS="$TEST_LIBS -lprotoc"] [],
-    [AC_MSG_ERROR([cannot find libprotoc])])
-  LIBS=$SAVED_LIBS
+  # Lines removed to prevent OLA from checking for Protoc Headers which are not relevant
 fi
 AC_SUBST([OLA_PROTOC])
-AM_CONDITIONAL(BUILD_OLA_PROTOC_PLUGIN, test "${with_ola_protoc_plugin}" == "no")
+AM_CONDITIONAL(BUILD_OLA_PROTOC_PLUGIN, test "${with_ola_protoc_plugin}" = "no")
 ])
 
 
@@ -144,7 +117,7 @@
   fi
 
   # If dependencies are not met...
-  if test "$3" == "no"; then
+  if test "$3" = "no"; then
     # ...and the user has explicitly requested this plugin to be enabled,
     # error out.
     if test "${enable_plugin}" = "yes"; then
